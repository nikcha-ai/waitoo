<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>waitoo - Discover a new you</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts for a playful yet clean look -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for social media icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <style>
        /* Custom styles for the animated multi-color gradient */
        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .animated-gradient {
            background: linear-gradient(-45deg, #f0f9ff, #fdf2f8, #f0fdf4, #fffbeb);
            background-size: 400% 400%;
            animation: gradient-animation 25s ease infinite;
        }

        /* Custom glow effect on hover */
        .card-glow {
            transition: all 0.3s ease;
        }
        .card-glow:hover {
            box-shadow: 0 0 20px #8b5cf6, 0 0 30px #ec4899, 0 0 40px #f9a8d4;
            transform: translateY(-5px) scale(1.02);
        }
        /* Custom font families */
        .font-poppins { font-family: 'Poppins', sans-serif; }
        .font-playfair { font-family: 'Playfair Display', serif; }

        /* Ensuring the page takes up the full height of the viewport */
        html, body {
            min-height: 100vh;
        }

        /* Styles for the chat page and bubbles */
        .chat-container {
            max-height: 70vh;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            padding: 1rem;
        }
        .message-user {
            background-color: #d1fae5; /* Green for user messages */
            border-radius: 1.5rem 1.5rem 0 1.5rem;
            align-self: flex-end;
            max-width: 80%;
        }
        .message-ai {
            background-color: #e0e7ff; /* Light blue/purple for AI messages */
            border-radius: 1.5rem 1.5rem 1.5rem 0;
            align-self: flex-start;
            max-width: 80%;
        }
        .chat-input-area {
            position: sticky;
            bottom: 0;
            background: white;
            padding: 1rem;
            border-top: 1px solid #e5e7eb;
        }
        
        /* New background patterns for chat pages */
        .single-chat-bg {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath fill='%2360a5fa' opacity='0.1' d='M50 0L61.8 38.2L100 38.2L69.1 61.8L80.9 100L50 76.4L19.1 100L30.9 61.8L0 38.2L38.2 38.2Z'/%3E%3Cpath fill='%23ef4444' opacity='0.1' d='M50 38.8C35.5 17.5 15.6 2.9 0 0v100h100V0C84.4 2.9 64.5 17.5 50 38.8z'/%3E%3C/svg%3E");
            background-size: 50px;
            background-repeat: repeat;
        }
        .new-couple-chat-bg {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath fill='%23ec4899' opacity='0.1' d='M50 38.8C35.5 17.5 15.6 2.9 0 0v100h100V0C84.4 2.9 64.5 17.5 50 38.8z'/%3E%3Cpath fill='%23f9a8d4' opacity='0.1' d='M83.8 16.2L16.2 83.8M16.2 16.2L83.8 83.8' stroke='%23f9a8d4' stroke-width='2'/%3E%3C/svg%3E");
            background-size: 50px;
            background-repeat: repeat;
        }
        .married-chat-bg {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='40' cy='50' r='30' fill='%238b5cf6' opacity='0.1'/%3E%3Ccircle cx='60' cy='50' r='30' fill='%23c4b5fd' opacity='0.1'/%3E%3C/svg%3E");
            background-size: 80px;
            background-repeat: repeat;
        }

        /* Modal/Popup specific styles */
        .result-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        .result-box {
            background-color: white;
            padding: 2rem;
            border-radius: 2rem;
            text-align: center;
            max-width: 90%;
            animation: bounceIn 0.8s ease-out forwards;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); }
        }
        .flame-animated-text {
            display: inline-block;
            transition: all 0.3s ease;
        }
        .flame-animated-text.active {
            color: #ef4444;
            font-weight: bold;
            transform: scale(1.2);
        }
        .flame-text {
            text-align: center;
            letter-spacing: 0.5rem;
            font-size: 3rem;
            font-family: 'Playfair Display', serif;
            color: #ccc;
            margin-bottom: 1rem;
        }

        /* CSS for the circular progress bar animation */
        .circle-wrap {
            width: 150px;
            height: 150px;
            background: #e6e2e0;
            border-radius: 50%;
            margin: 0 auto 1.5rem;
        }
        .circle-wrap .circle .mask {
            width: 150px;
            height: 150px;
            position: absolute;
            border-radius: 50%;
        }
        .circle-wrap .circle .mask .fill {
            width: 150px;
            height: 150px;
            position: absolute;
            border-radius: 50%;
            background-color: #2dd4bf;
        }
        .circle-wrap .circle .mask.full,
        .circle-wrap .circle .fill {
            animation: fill-animation 2s forwards;
            -webkit-animation: fill-animation 2s forwards;
        }
        .circle-wrap .circle .mask {
            clip: rect(0px, 150px, 150px, 75px);
        }
        .circle-wrap .circle .mask .fill {
            clip: rect(0px, 75px, 150px, 0px);
        }
        .circle-wrap .circle .mask.full {
            -webkit-animation: fill-animation 2s forwards;
            animation: fill-animation 2s forwards;
        }

        /* The percentage value from JS will be added to this keyframe */
        @keyframes fill-animation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(var(--percentage)); }
        }
        .circle-wrap .inside-circle {
            width: 130px;
            height: 130px;
            border-radius: 50%;
            background: #fff;
            line-height: 130px;
            text-align: center;
            margin-top: 10px;
            margin-left: 10px;
            position: absolute;
            z-index: 10;
            font-weight: bold;
            font-size: 2.5rem;
            color: #2dd4bf;
        }
    </style>
    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, addDoc, setDoc, updateDoc, onSnapshot, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        window.firebase = {
            initializeApp,
            getAuth,
            signInAnonymously,
            signInWithCustomToken,
            onAuthStateChanged,
            getFirestore,
            doc,
            getDoc,
            addDoc,
            setDoc,
            updateDoc,
            onSnapshot,
            collection,
            query,
            where,
            getDocs
        };
    </script>
</head>
<body class="animated-gradient font-poppins text-gray-800 flex flex-col min-h-screen">

    <!-- Main container for layout -->
    <div class="container mx-auto px-4 py-8 max-w-6xl flex-grow flex flex-col">

        <!-- Header Section - Stays the same on all pages -->
        <header class="flex justify-between items-center py-4 px-6 mb-8 bg-white/70 backdrop-blur-sm rounded-full shadow-lg sticky top-0 z-50">
            <h1 class="text-3xl font-bold font-playfair text-purple-600">waitoo</h1>
            <nav>
                <ul class="flex space-x-6 text-lg font-poppins">
                    <li><a href="#" class="text-gray-600 hover:text-purple-600 transition-colors duration-300" onclick="showPage('home-page')">Home</a></li>
                    <li><a href="#" class="text-gray-600 hover:text-purple-600 transition-colors duration-300" onclick="showPage('about-page')">About</a></li>
                    <li><a href="#" class="text-gray-600 hover:text-purple-600 transition-colors duration-300" onclick="showPage('contact-page')">Contact</a></li>
                    <li><a href="#" class="text-gray-600 hover:text-purple-600 transition-colors duration-300" onclick="showPage('login-page')">Login</a></li>
                </ul>
            </nav>
        </header>

        <!-- Main content area for all pages -->
        <main class="flex-grow">
            <!-- ============================================== -->
            <!-- HOME PAGE (Visible by default) -->
            <!-- ============================================== -->
            <div id="home-page">
                <!-- Hero Section -->
                <section class="text-center mb-16">
                    <div class="bg-purple-100/70 rounded-3xl p-8 md:p-12 shadow-2xl backdrop-blur-sm">
                        <h2 class="text-4xl md:text-6xl font-bold mb-4 font-playfair leading-tight text-purple-800">
                            Discover a new you with our AI simulation. Share your story.
                        </h2>
                        <p class="text-lg md:text-xl text-gray-600 font-poppins max-w-3xl mx-auto mb-8">
                            You share your story we will give you a new wings with AI to fly high in your life.
                        </p>
                        <div class="flex flex-col sm:flex-row justify-center gap-4">
                            <button class="px-8 py-4 bg-purple-600 text-white text-lg font-semibold rounded-full shadow-xl hover:bg-purple-700 transition-colors duration-300" onclick="showPage('demo-page')">
                                Try Demo
                            </button>
                            <button class="px-8 py-4 bg-pink-500 text-white text-lg font-semibold rounded-full shadow-xl hover:bg-pink-600 transition-colors duration-300" onclick="showPage('signup-page')">
                                Signup
                            </button>
                        </div>
                        <img src="https://placehold.co/1200x500/fecdd3/ec4899?text=Happy+Couple" alt="Placeholder for your main image" class="w-full h-auto mt-12 rounded-2xl shadow-xl border-4 border-white/50 object-cover">
                    </div>
                </section>

                <!-- Large Cards Section - Now with `onclick` to navigate to new pages -->
                <section class="mb-16">
                    <h3 class="text-4xl font-bold font-playfair text-center mb-8 text-purple-800">Your Journey, Your Path</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div id="single-card" class="bg-white/80 backdrop-blur-sm rounded-xl p-6 shadow-xl card-glow cursor-pointer" onclick="showChatPage('single')">
                            <img src="https://placehold.co/800x600/60a5fa/ffffff?text=Image+for+Single+Card" alt="A single person enjoying life" class="w-full h-64 object-cover rounded-lg mb-4">
                            <h4 class="text-2xl font-bold text-center text-blue-500 font-playfair">Single</h4>
                            <p class="text-center mt-2 text-gray-600">Discover self-love and your true potential.</p>
                        </div>
                        <div id="new-couple-card" class="bg-white/80 backdrop-blur-sm rounded-xl p-6 shadow-xl card-glow cursor-pointer" onclick="showChatPage('new-couple')">
                            <img src="https://placehold.co/800x600/fecdd3/ec4899?text=Image+for+New+Couple+Card" alt="A new couple holding hands" class="w-full h-64 object-cover rounded-lg mb-4">
                            <h4 class="text-2xl font-bold text-center text-pink-500 font-playfair">New Couple</h4>
                            <p class="text-center mt-2 text-gray-600">Navigate the early stages of a new relationship.</p>
                        </div>
                        <div id="married-card" class="bg-white/80 backdrop-blur-sm rounded-xl p-6 shadow-xl card-glow cursor-pointer" onclick="showChatPage('married')">
                            <img src="https://placehold.co/800x600/8b5cf6/ffffff?text=Image+for+Married+Card" alt="A happily married couple" class="w-full h-64 object-cover rounded-lg mb-4">
                            <h4 class="text-2xl font-bold text-center text-purple-500 font-playfair">Married Couple</h4>
                            <p class="text-center mt-2 text-gray-600">Strengthen your bond and find harmony.</p>
                        </div>
                    </div>
                </section>

                <!-- Small Cards Section -->
                <section class="mb-16">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div class="bg-white/80 backdrop-blur-sm rounded-xl p-6 shadow-xl card-glow cursor-pointer text-center" onclick="showPage('lovematch-page')">
                            <h4 class="text-xl font-bold text-red-500">Lovematch</h4>
                        </div>
                        <div class="bg-white/80 backdrop-blur-sm rounded-xl p-6 shadow-xl card-glow cursor-pointer text-center" onclick="showPage('compatibility-page')">
                            <h4 class="text-xl font-bold text-teal-500">Check Your Compatibility</h4>
                        </div>
                        <div class="bg-white/80 backdrop-blur-sm rounded-xl p-6 shadow-xl card-glow cursor-pointer text-center" onclick="showPage('hookme-page')">
                            <h4 class="text-xl font-bold text-yellow-500">Hook Me</h4>
                        </div>
                    </div>
                </section>

                <!-- Testimonials Section -->
                <section class="mb-16">
                    <h3 class="text-4xl font-bold font-playfair text-center mb-8 text-purple-800">What Our Happy Clients Say</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="bg-white/70 backdrop-blur-sm rounded-xl p-6 shadow-xl border-l-4 border-pink-500">
                            <p class="font-poppins italic text-gray-700">"Waitoo helped me understand myself better after my divorce. I feel like I have a fresh start. Highly recommend!"</p>
                            <p class="mt-4 font-bold text-gray-800">- Jane D.</p>
                        </div>
                        <div class="bg-white/70 backdrop-blur-sm rounded-xl p-6 shadow-xl border-l-4 border-blue-500">
                            <p class="font-poppins italic text-gray-700">"We used the compatibility feature and it was so much fun! It gave us great insights into our relationship."</p>
                            <p class="mt-4 font-bold text-gray-800">- Mark and Sarah</p>
                        </div>
                    </div>
                </section>
            </div>

            <!-- ============================================== -->
            <!-- AI CHAT PAGES (Hidden by default) -->
            <!-- ============================================== -->
            <div id="single-chat-page" class="hidden h-full flex flex-col justify-between bg-blue-100/70 rounded-3xl shadow-2xl backdrop-blur-sm">
                <div class="p-6">
                    <h2 class="text-4xl font-bold font-playfair text-blue-800 text-center mb-4">Single's Chat</h2>
                    <p class="text-center text-gray-700 mb-6">
                        Hey there! I'm here to listen. Let's talk about self-love, personal growth, or anything else on your mind.
                    </p>
                    <button class="px-6 py-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors duration-300" onclick="showPage('home-page')">
                        &larr; Back to Home
                    </button>
                </div>
                <div id="single-chat-container" class="chat-container flex-grow single-chat-bg"></div>
                <div class="chat-input-area flex items-center gap-4">
                    <input type="text" id="single-chat-input" placeholder="Start typing your story..." class="flex-grow rounded-full p-3 bg-gray-100 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <button id="single-chat-send-btn" class="px-6 py-3 bg-blue-500 text-white rounded-full font-semibold hover:bg-blue-600 transition-colors duration-300">Send</button>
                </div>
            </div>

            <div id="new-couple-chat-page" class="hidden h-full flex flex-col justify-between bg-pink-100/70 rounded-3xl shadow-2xl backdrop-blur-sm">
                <div class="p-6">
                    <h2 class="text-4xl font-bold font-playfair text-pink-800 text-center mb-4">New Couple Chat</h2>
                    <p class="text-center text-gray-700 mb-6">
                        Hi! I'm an AI companion to help you navigate your new relationship. We can discuss communication, fun date ideas, or anything that comes up.
                    </p>
                    <button class="px-6 py-2 bg-pink-600 text-white rounded-full hover:bg-pink-700 transition-colors duration-300" onclick="showPage('home-page')">
                        &larr; Back to Home
                    </button>
                </div>
                <div id="new-couple-chat-container" class="chat-container flex-grow new-couple-chat-bg"></div>
                <div class="chat-input-area flex items-center gap-4">
                    <input type="text" id="new-couple-chat-input" placeholder="Share a story or ask a question..." class="flex-grow rounded-full p-3 bg-gray-100 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-pink-500">
                    <button id="new-couple-chat-send-btn" class="px-6 py-3 bg-pink-500 text-white rounded-full font-semibold hover:bg-pink-600 transition-colors duration-300">Send</button>
                </div>
            </div>

            <div id="married-chat-page" class="hidden h-full flex flex-col justify-between bg-purple-100/70 rounded-3xl shadow-2xl backdrop-blur-sm">
                <div class="p-6">
                    <h2 class="text-4xl font-bold font-playfair text-purple-800 text-center mb-4">Married Couple Chat</h2>
                    <p class="text-center text-gray-700 mb-6">
                        Hello! I'm here to support your lifelong journey together. Let's talk about strengthening your bond or finding harmony in your marriage.
                    </p>
                    <button class="px-6 py-2 bg-purple-600 text-white rounded-full hover:bg-purple-700 transition-colors duration-300" onclick="showPage('home-page')">
                        &larr; Back to Home
                    </button>
                </div>
                <div id="married-chat-container" class="chat-container flex-grow married-chat-bg"></div>
                <div class="chat-input-area flex items-center gap-4">
                    <input type="text" id="married-chat-input" placeholder="Talk about your day or ask for advice..." class="flex-grow rounded-full p-3 bg-gray-100 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500">
                    <button id="married-chat-send-btn" class="px-6 py-3 bg-purple-500 text-white rounded-full font-semibold hover:bg-purple-600 transition-colors duration-300">Send</button>
                </div>
            </div>

            <!-- ============================================== -->
            <!-- LOVEMATCH PAGE -->
            <!-- ============================================== -->
            <div id="lovematch-page" class="hidden h-full flex flex-col justify-center items-center bg-red-100/70 rounded-3xl shadow-2xl backdrop-blur-sm p-8">
                <h2 class="text-5xl font-bold font-playfair text-red-800 mb-6 text-center">Lovematch</h2>
                <p class="text-xl text-gray-700 text-center mb-8">Discover your compatibility with the classic FLAMES game!</p>
                
                <div class="bg-white/80 p-8 rounded-xl shadow-xl w-full max-w-md">
                    <form id="flames-form" class="space-y-6">
                        <div>
                            <label for="flames-name1" class="block text-gray-700 font-bold mb-2">First Person's Name</label>
                            <input type="text" id="flames-name1" name="name1" placeholder="Enter name 1..." class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500">
                        </div>
                        <div>
                            <label for="flames-name2" class="block text-gray-700 font-bold mb-2">Second Person's Name</label>
                            <input type="text" id="flames-name2" name="name2" placeholder="Enter name 2..." class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500">
                        </div>
                        <div class="text-center">
                            <button type="submit" class="w-full px-8 py-4 bg-red-500 text-white text-lg font-semibold rounded-full shadow-xl hover:bg-red-600 transition-colors duration-300">
                                Start FLAMES!
                            </button>
                        </div>
                    </form>
                </div>
                
                <div id="flames-result-area" class="mt-8 text-center p-4">
                    <!-- Results will be displayed here -->
                </div>
                
                <button class="mt-8 px-6 py-2 bg-gray-500 text-white rounded-full hover:bg-gray-600 transition-colors duration-300" onclick="showPage('home-page')">
                    &larr; Back to Home
                </button>
            </div>
            
            <!-- ============================================== -->
            <!-- ASTROLOGY COMPATIBILITY PAGE (New) -->
            <!-- ============================================== -->
            <div id="compatibility-page" class="hidden h-full flex flex-col justify-center items-center bg-teal-100/70 rounded-3xl shadow-2xl backdrop-blur-sm p-8">
                <h2 class="text-5xl font-bold font-playfair text-teal-800 mb-6 text-center">Astrology Compatibility</h2>
                <p class="text-xl text-gray-700 text-center mb-8">Enter your details to find your cosmic compatibility!</p>
                
                <div class="bg-white/80 p-8 rounded-xl shadow-xl w-full max-w-2xl grid grid-cols-1 md:grid-cols-2 gap-8">
                    <form id="compatibility-form" class="space-y-6 md:col-span-2">
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                            <!-- User 1 Form -->
                            <div class="space-y-4">
                                <h3 class="text-2xl font-bold text-teal-600">User 1</h3>
                                <div>
                                    <label for="user1-name" class="block text-gray-700 font-bold mb-2">First Name</label>
                                    <input type="text" id="user1-name" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500" required>
                                </div>
                                <div>
                                    <label for="user1-dob" class="block text-gray-700 font-bold mb-2">Date of Birth</label>
                                    <input type="date" id="user1-dob" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500" required>
                                </div>
                                <div>
                                    <label for="user1-sex" class="block text-gray-700 font-bold mb-2">Sex</label>
                                    <select id="user1-sex" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500" required>
                                        <option value="">Select</option>
                                        <option value="male">Male</option>
                                        <option value="female">Female</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="user1-pob" class="block text-gray-700 font-bold mb-2">Place of Birth</label>
                                    <input type="text" id="user1-pob" placeholder="City, Country" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500" required>
                                </div>
                                <div>
                                    <label for="user1-tob" class="block text-gray-700 font-bold mb-2">Birth Time</label>
                                    <input type="time" id="user1-tob" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500" required>
                                </div>
                            </div>
                            <!-- User 2 Form -->
                            <div class="space-y-4">
                                <h3 class="text-2xl font-bold text-teal-600">User 2</h3>
                                <div>
                                    <label for="user2-name" class="block text-gray-700 font-bold mb-2">First Name</label>
                                    <input type="text" id="user2-name" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500" required>
                                </div>
                                <div>
                                    <label for="user2-dob" class="block text-gray-700 font-bold mb-2">Date of Birth</label>
                                    <input type="date" id="user2-dob" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500" required>
                                </div>
                                <div>
                                    <label for="user2-sex" class="block text-gray-700 font-bold mb-2">Sex</label>
                                    <select id="user2-sex" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500" required>
                                        <option value="">Select</option>
                                        <option value="male">Male</option>
                                        <option value="female">Female</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="user2-pob" class="block text-gray-700 font-bold mb-2">Place of Birth</label>
                                    <input type="text" id="user2-pob" placeholder="City, Country" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500" required>
                                </div>
                                <div>
                                    <label for="user2-tob" class="block text-gray-700 font-bold mb-2">Birth Time</label>
                                    <input type="time" id="user2-tob" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500" required>
                                </div>
                            </div>
                        </div>
                        <div class="text-center mt-8">
                            <button type="submit" class="w-full px-8 py-4 bg-teal-500 text-white text-lg font-semibold rounded-full shadow-xl hover:bg-teal-600 transition-colors duration-300">
                                Find Compatibility
                            </button>
                        </div>
                    </form>
                </div>
                
                <button class="mt-8 px-6 py-2 bg-gray-500 text-white rounded-full hover:bg-gray-600 transition-colors duration-300" onclick="showPage('home-page')">
                    &larr; Back to Home
                </button>
            </div>
            
            <!-- ============================================== -->
            <!-- HOOK ME PAGE (New) -->
            <!-- ============================================== -->
            <div id="hookme-page" class="hidden h-full flex flex-col items-center bg-yellow-100/70 rounded-3xl shadow-2xl backdrop-blur-sm p-8">
                <div id="hookme-main-view" class="w-full">
                    <h2 class="text-5xl font-bold font-playfair text-yellow-800 mb-6 text-center">Hook Me</h2>
                    <p class="text-xl text-gray-700 text-center mb-8">Find your perfect match and start a new connection!</p>
                    
                    <div class="flex flex-col md:flex-row gap-8 bg-white/80 p-6 rounded-xl shadow-xl w-full max-w-4xl mx-auto">
                        <!-- Logged-in User Profile -->
                        <div id="logged-in-user" class="w-full md:w-1/3 p-4 bg-yellow-50 rounded-xl shadow-md border-2 border-yellow-200">
                            <h3 class="text-2xl font-bold font-playfair text-yellow-600 text-center mb-4">Your Profile</h3>
                            <div id="user-profile-card" class="flex flex-col items-center text-center">
                                <!-- User info will be rendered here -->
                            </div>
                        </div>
                        
                        <!-- Other Users Grid -->
                        <div class="w-full md:w-2/3 p-4 bg-yellow-50 rounded-xl shadow-md border-2 border-yellow-200">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-2xl font-bold font-playfair text-yellow-600">Find a Match</h3>
                                <button id="add-mock-user-btn" class="px-4 py-2 bg-yellow-500 text-white rounded-full text-sm font-semibold hover:bg-yellow-600 transition-colors duration-300">
                                    Add New User
                                </button>
                            </div>
                            <div id="other-users-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 overflow-y-auto max-h-96">
                                <!-- Other user cards will be rendered here -->
                                <p id="no-users-message" class="col-span-full text-center text-gray-500 italic hidden">No users found yet. Add some mock users to get started!</p>
                            </div>
                            <div id="loading-users" class="text-center mt-4">
                                <div class="flex justify-center items-center space-x-2 text-gray-500">
                                    <div class="h-4 w-4 bg-gray-400 rounded-full animate-bounce"></div>
                                    <div class="h-4 w-4 bg-gray-400 rounded-full animate-bounce delay-100"></div>
                                    <div class="h-4 w-4 bg-gray-400 rounded-full animate-bounce delay-200"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Detailed User Profile View -->
                <div id="hookme-profile-view" class="hidden w-full max-w-2xl bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl p-8 mt-8">
                    <button class="mb-4 px-4 py-2 bg-gray-500 text-white rounded-full hover:bg-gray-600 transition-colors duration-300" onclick="showHookMeMainView()">
                        &larr; Back to Matches
                    </button>
                    <div id="detailed-user-profile-content">
                        <!-- Detailed profile will be rendered here -->
                    </div>
                    <div class="flex flex-wrap justify-center gap-4 mt-6">
                        <button class="px-6 py-3 bg-red-500 text-white font-semibold rounded-full shadow-lg hover:bg-red-600 transition-colors duration-300" onclick="handleHookMeAction('Hook Me')">
                            Hook Me
                        </button>
                        <button class="px-6 py-3 bg-pink-500 text-white font-semibold rounded-full shadow-lg hover:bg-pink-600 transition-colors duration-300" onclick="handleHookMeAction('Send Flowers')">
                            Send Flowers
                        </button>
                        <button class="px-6 py-3 bg-blue-500 text-white font-semibold rounded-full shadow-lg hover:bg-blue-600 transition-colors duration-300" onclick="handleHookMeAction('Chat')">
                            Chat
                        </button>
                    </div>
                </div>
                <button class="mt-8 px-6 py-2 bg-gray-500 text-white rounded-full hover:bg-gray-600 transition-colors duration-300" onclick="showPage('home-page')">
                    &larr; Back to Home
                </button>
            </div>


            <!-- ============================================== -->
            <!-- OTHER STATIC PAGES (Hidden by default) -->
            <!-- ============================================== -->
            <div id="about-page" class="hidden text-center p-8">
                <h2 class="text-5xl font-bold font-playfair text-purple-800 mb-4">About Us</h2>
                <p class="text-xl text-gray-700">We are dedicated to helping people in their relationships through AI simulation.</p>
                <button class="mt-8 px-8 py-4 bg-gray-500 text-white text-lg font-semibold rounded-full shadow-xl hover:bg-gray-600 transition-colors duration-300" onclick="showPage('home-page')">
                    &larr; Back to Home
                </button>
            </div>
            <div id="contact-page" class="hidden text-center p-8">
                <h2 class="text-5xl font-bold font-playfair text-purple-800 mb-4">Contact Us</h2>
                <p class="text-xl text-gray-700">Get in touch with us at support@waitoo.com.</p>
                <button class="mt-8 px-8 py-4 bg-gray-500 text-white text-lg font-semibold rounded-full shadow-xl hover:bg-gray-600 transition-colors duration-300" onclick="showPage('home-page')">
                    &larr; Back to Home
                </button>
            </div>
            <div id="login-page" class="hidden text-center p-8">
                <h2 class="text-5xl font-bold font-playfair text-purple-800 mb-4">Login</h2>
                <p class="text-xl text-gray-700">This is where the login form would be.</p>
                <button class="mt-8 px-8 py-4 bg-gray-500 text-white text-lg font-semibold rounded-full shadow-xl hover:bg-gray-600 transition-colors duration-300" onclick="showPage('home-page')">
                    &larr; Back to Home
                </button>
            </div>
            <div id="demo-page" class="hidden text-center p-8">
                <h2 class="text-5xl font-bold font-playfair text-purple-800 mb-4">Try Our Demo</h2>
                <p class="text-xl text-gray-700">This is a placeholder for the AI simulation demo.</p>
                <button class="mt-8 px-8 py-4 bg-gray-500 text-white text-lg font-semibold rounded-full shadow-xl hover:bg-gray-600 transition-colors duration-300" onclick="showPage('home-page')">
                    &larr; Back to Home
                </button>
            </div>
            <div id="signup-page" class="hidden text-center p-8">
                <h2 class="text-5xl font-bold font-playfair text-purple-800 mb-4">Sign Up</h2>
                <p class="text-xl text-gray-700">This is a placeholder for the sign up form.</p>
                <button class="mt-8 px-8 py-4 bg-gray-500 text-white text-lg font-semibold rounded-full shadow-xl hover:bg-gray-600 transition-colors duration-300" onclick="showPage('home-page')">
                    &larr; Back to Home
                </button>
            </div>
        </main>
    </div>

    <!-- Footer Section is below this line. It should now always be visible. -->
    <footer class="text-center mt-16 py-8 text-gray-600 font-poppins bg-white/70 backdrop-blur-sm">
        <!-- Social Media Icons -->
        <div class="flex justify-center space-x-6 mb-4 text-2xl">
            <a href="#" class="text-gray-600 hover:text-blue-500 transition-colors duration-300"><i class="fab fa-facebook"></i></a>
            <a href="#" class="text-gray-600 hover:text-pink-500 transition-colors duration-300"><i class="fab fa-instagram"></i></a>
            <a href="#" class="text-gray-600 hover:text-blue-400 transition-colors duration-300"><i class="fab fa-twitter"></i></a>
            <a href="#" class="text-gray-600 hover:text-red-600 transition-colors duration-300"><i class="fab fa-youtube"></i></a>
        </div>
        <!-- Copyright Text -->
        <p>&copy; 2025 waitoo. All rights reserved.</p>
    </footer>
    
    <!-- JavaScript to handle page navigation, AI chat, Lovematch, and Firestore -->
    <script type="module">
        // Import necessary Firebase functions from the global window object
        const {
            initializeApp,
            getAuth,
            signInAnonymously,
            signInWithCustomToken,
            onAuthStateChanged,
            getFirestore,
            doc,
            addDoc,
            setDoc,
            onSnapshot,
            collection,
            query,
            getDocs
        } = window.firebase;
        
        // ===============================================
        // Firebase Setup and Initialization
        // ===============================================
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let db, auth;
        let userId = null;
        let loggedInUser = null;
        let otherUsers = [];
        
        // Function to initialize Firebase and sign in
        async function initializeFirebase() {
            try {
                const app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);

                // Sign in the user using the custom token or anonymously
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }

                // Listen for auth state changes to get the user ID
                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        userId = user.uid;
                        console.log("Firebase initialized. User ID:", userId);
                        setupHookMePage();
                    } else {
                        console.log("No user signed in.");
                    }
                });
            } catch (error) {
                console.error("Error initializing Firebase or signing in:", error);
            }
        }
        
        // Run initialization on DOM content loaded
        document.addEventListener('DOMContentLoaded', initializeFirebase);

        // ===============================================
        // Page Navigation and UI Logic
        // ===============================================
        const pageIds = [
            'home-page', 'single-chat-page', 'new-couple-chat-page', 'married-chat-page',
            'about-page', 'contact-page', 'login-page', 'demo-page',
            'signup-page', 'lovematch-page', 'compatibility-page', 'hookme-page'
        ];

        function showPage(pageId) {
            pageIds.forEach(id => {
                const page = document.getElementById(id);
                if (page) {
                    page.classList.add('hidden');
                }
            });
            const pageToShow = document.getElementById(pageId);
            if (pageToShow) {
                pageToShow.classList.remove('hidden');
            } else {
                console.error('Page not found:', pageId);
            }
        }

        // ===============================================
        // AI Chat Logic
        // ===============================================
        let chatHistories = { 'single': [], 'new-couple': [], 'married': [] };
        const personas = {
            'single': { name: "Solo Sensei", prompt: "You are a supportive, and empowering AI mentor for single individuals. Your tone is encouraging and kind. Keep your responses concise and conversational, and always end with a question to encourage further dialogue." },
            'new-couple': { name: "Couple's Compass", prompt: "You are an empathetic and helpful AI guide for new couples. Your tone is friendly, positive, and insightful. Keep your responses concise and conversational, and always end with a question to encourage further dialogue." },
            'married': { name: "Harmony Helper", prompt: "You are a wise and compassionate AI counselor for married couples. Your tone is mature, understanding, and reassuring. Keep your responses concise and conversational, and always end with a question to encourage further dialogue." }
        };
        
        function showChatPage(chatId) {
            chatHistories[chatId] = [];
            const chatContainer = document.getElementById(chatId + '-chat-container');
            chatContainer.innerHTML = '';
            showPage(chatId + '-chat-page');
            const welcomeMessage = `Hello! I'm your personal AI companion, ${personas[chatId].name}. How can I help you today?`;
            addAiMessage(chatId, welcomeMessage);
            chatHistories[chatId].push({ role: "model", parts: [{ text: welcomeMessage }] });
        }
        
        function addUserMessage(chatId, message) {
            const container = document.getElementById(chatId + '-chat-container');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'bg-green-200 text-gray-800 p-4 rounded-xl shadow-md message-user';
            messageDiv.textContent = message;
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        function addAiMessage(chatId, message) {
            const container = document.getElementById(chatId + '-chat-container');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'bg-indigo-200 text-gray-800 p-4 rounded-xl shadow-md message-ai';
            messageDiv.innerHTML = message.replace(/\n/g, '<br>');
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        function showLoading(chatId) {
            const container = document.getElementById(chatId + '-chat-container');
            const loadingDiv = document.createElement('div');
            loadingDiv.id = 'loading-indicator-' + chatId;
            loadingDiv.className = 'flex items-center space-x-2 text-gray-500 p-2 message-ai';
            loadingDiv.innerHTML = `
                <div class="h-4 w-4 bg-gray-400 rounded-full animate-bounce delay-100"></div>
                <div class="h-4 w-4 bg-gray-400 rounded-full animate-bounce delay-200"></div>
                <div class="h-4 w-4 bg-gray-400 rounded-full animate-bounce delay-300"></div>
            `;
            container.appendChild(loadingDiv);
            container.scrollTop = container.scrollHeight;
        }

        function hideLoading(chatId) {
            const loadingDiv = document.getElementById('loading-indicator-' + chatId);
            if (loadingDiv) loadingDiv.remove();
        }

        async function handleChat(chatId) {
            const inputElement = document.getElementById(chatId + '-chat-input');
            const userMessage = inputElement.value.trim();
            if (!userMessage) return;
            addUserMessage(chatId, userMessage);
            inputElement.value = '';
            showLoading(chatId);
            chatHistories[chatId].push({ role: "user", parts: [{ text: userMessage }] });
            const fullHistory = [{ role: "user", parts: [{ text: personas[chatId].prompt }] }];
            fullHistory.push(...chatHistories[chatId]);
            
            try {
                const payload = { contents: fullHistory };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                
                let response;
                let retryDelay = 1000;
                let retries = 0;
                const maxRetries = 5;
                while (retries < maxRetries) {
                    try {
                        response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        if (response.status === 429) { retries++; await new Promise(res => setTimeout(res, retryDelay)); retryDelay *= 2; }
                        else if (!response.ok) { throw new Error(`API call failed with status: ${response.status}`); }
                        else { break; }
                    } catch (error) { retries++; console.error('Fetch attempt failed:', error); if (retries >= maxRetries) { throw error; } await new Promise(res => setTimeout(res, retryDelay)); retryDelay *= 2; }
                }
                if (!response || !response.ok) { throw new Error("Failed to get a response from the API after multiple retries."); }

                const result = await response.json();
                const aiResponse = result.candidates?.[0]?.content?.parts?.[0]?.text || "I'm sorry, I couldn't generate a response. Please try again.";
                addAiMessage(chatId, aiResponse);
                chatHistories[chatId].push({ role: "model", parts: [{ text: aiResponse }] });
            } catch (error) {
                console.error("Failed to fetch from Gemini API:", error);
                addAiMessage(chatId, "Oops, something went wrong. Please try again later.");
            } finally {
                hideLoading(chatId);
            }
        }
        
        // ===============================================
        // Lovematch Game Logic
        // ===============================================
        const flameWordsMap = { 'F': "Flirtation", 'L': "Love", 'A': "Affair", 'M': "Marriage", 'E': "Enemies", 'S': "Siblings" };
        const flameLetters = ['F', 'L', 'A', 'M', 'E', 'S'];

        async function runFlamesGame(event) {
            event.preventDefault();
            const name1 = document.getElementById('flames-name1').value.toLowerCase().replace(/[^a-z]/g, '');
            const name2 = document.getElementById('flames-name2').value.toLowerCase().replace(/[^a-z]/g, '');
            if (!name1 || !name2) {
                alert("Please enter both names to play!");
                return;
            }
            let arr1 = name1.split('');
            let arr2 = name2.split('');
            for (let i = 0; i < arr1.length; i++) {
                const char = arr1[i];
                const index = arr2.indexOf(char);
                if (index !== -1) {
                    arr1.splice(i, 1);
                    arr2.splice(index, 1);
                    i--;
                }
            }
            const totalCount = arr1.length + arr2.length;
            const resultIndex = (totalCount - 1 + flameLetters.length) % flameLetters.length;
            const finalResultWord = flameWordsMap[flameLetters[resultIndex]];
            const resultArea = document.getElementById('flames-result-area');
            resultArea.innerHTML = `<h3 class="text-4xl font-bold font-playfair text-red-600 mb-4">Calculating...</h3>`;
            let currentIndex = 0;
            const animationInterval = setInterval(() => {
                let text = '';
                for (let i = 0; i < flameLetters.length; i++) {
                    const className = i === currentIndex ? 'text-red-500 font-bold text-5xl' : 'text-gray-400 text-3xl';
                    text += `<span class="flame-animated-text ${className}">${flameLetters[i]}</span>`;
                }
                resultArea.innerHTML = `<p class="flame-text">${text}</p>`;
                if (currentIndex === resultIndex) {
                    clearInterval(animationInterval);
                    showFlamesResult(finalResultWord, name1, name2);
                }
                currentIndex = (currentIndex + 1) % flameLetters.length;
            }, 300);
        }

        async function showFlamesResult(resultWord, name1, name2) {
            const resultArea = document.getElementById('flames-result-area');
            resultArea.innerHTML = `
                <div class="result-container">
                    <div class="result-box bg-red-100">
                        <h3 class="text-5xl font-bold font-playfair text-red-600 mb-4">The result is: ${resultWord}!</h3>
                        <div id="flames-ai-explanation" class="text-xl text-gray-700 mt-4 animate-pulse">Generating your personalized result...</div>
                        <button onclick="document.querySelector('.result-container').remove();" class="mt-6 px-6 py-3 bg-red-500 text-white font-semibold rounded-full hover:bg-red-600 transition-colors duration-300">Close</button>
                    </div>
                </div>
            `;
            const prompt = `Based on the FLAMES game result '${resultWord}' for the names '${name1}' and '${name2}', provide a short, fun, and witty explanation. The possible results are: Flirtation, Love, Affair, Marriage, Enemies, and Siblings. Keep the response to a maximum of two sentences and use a playful tone.`;
            try {
                const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                const payload = { contents: chatHistory };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                const result = await response.json();
                const explanation = result.candidates?.[0]?.content?.parts?.[0]?.text || "No custom explanation available.";
                document.getElementById('flames-ai-explanation').textContent = explanation;
                document.getElementById('flames-ai-explanation').classList.remove('animate-pulse');
            } catch (error) {
                console.error("AI explanation failed:", error);
                document.getElementById('flames-ai-explanation').textContent = "I'm sorry, I couldn't generate a custom explanation.";
                document.getElementById('flames-ai-explanation').classList.remove('animate-pulse');
            }
            document.querySelector('.result-container').addEventListener('click', (e) => { if (e.target.classList.contains('result-container')) { e.target.remove(); } });
        }
        
        // ===============================================
        // Astrology Compatibility Logic (Updated)
        // ===============================================
        async function runCompatibilityCheck(event) {
            event.preventDefault();
            const form = event.target;
            const user1Name = form['user1-name'].value;
            const user2Name = form['user2-name'].value;

            if (!user1Name || !user2Name) {
                alert('Please fill out all mandatory fields.');
                return;
            }

            const resultContainer = document.createElement('div');
            resultContainer.className = 'result-container';
            resultContainer.innerHTML = `
                <div class="result-box bg-teal-100">
                    <h3 class="text-4xl font-bold font-playfair text-teal-600 mb-4">Calculating Compatibility...</h3>
                    <div class="flex justify-center items-center space-x-4">
                        <div class="h-6 w-6 bg-teal-500 rounded-full animate-bounce"></div>
                        <div class="h-6 w-6 bg-teal-500 rounded-full animate-bounce delay-100"></div>
                        <div class="h-6 w-6 bg-teal-500 rounded-full animate-bounce delay-200"></div>
                    </div>
                    <p class="text-gray-600 mt-4">Analyzing cosmic alignment and astrological charts...</p>
                </div>
            `;
            document.body.appendChild(resultContainer);
            
            setTimeout(async () => {
                try {
                    const qualitiesMatch = Math.floor(Math.random() * 16) + 20; // Random between 20-35
                    const percentage = Math.round((qualitiesMatch / 36) * 100);

                    const prompt = `You are an AI astrologer. Provide a compatibility report for two people.
                    The report should have a fun and positive tone and include the following:
                    1. A compatibility percentage of ${percentage}%.
                    2. A score of ${qualitiesMatch} out of 36 matching qualities.
                    3. A short, a few sentences long, explanation of the compatibility. Use a friendly and encouraging tone. Don't mention specific astrological signs, just focus on the outcome. For example, for a good score, you could mention "great synergy" and for a lower one, "areas for growth".`;
                    
                    const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                    const payload = { contents: chatHistory };
                    const apiKey = "";
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                    
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    const result = await response.json();
                    let aiReport = result.candidates?.[0]?.content?.parts?.[0]?.text || "I'm sorry, I couldn't generate the compatibility report. Please try again.";

                    // Display the final result with animated circle
                    const angle = (percentage / 100) * 360;
                    const circleHtml = `
                        <div class="circle-wrap">
                            <div class="circle">
                                <div class="mask full">
                                    <div class="fill" style="transform: rotate(${angle}deg);"></div>
                                </div>
                                <div class="mask half">
                                    <div class="fill" style="transform: rotate(${angle}deg);"></div>
                                    <div class="fill fix" style="transform: rotate(${angle * 2}deg);"></div>
                                </div>
                                <div class="inside-circle">${percentage}%</div>
                            </div>
                        </div>
                    `;

                    resultContainer.innerHTML = `
                        <div class="result-box bg-teal-100">
                            <h3 class="text-4xl font-bold font-playfair text-teal-600 mb-4">Compatibility Found!</h3>
                            ${circleHtml}
                            <div class="text-2xl font-bold text-teal-700 mb-2">${qualitiesMatch} out of 36 matching qualities!</div>
                            <p class="text-lg text-gray-700">${aiReport}</p>
                            <button onclick="document.querySelector('.result-container').remove();" class="mt-6 px-6 py-3 bg-teal-500 text-white font-semibold rounded-full hover:bg-teal-600 transition-colors duration-300">Close</button>
                        </div>
                    `;
                } catch (error) {
                    console.error("AI compatibility check failed:", error);
                    resultContainer.innerHTML = `
                        <div class="result-box bg-teal-100">
                            <h3 class="text-4xl font-bold font-playfair text-teal-600 mb-4">Calculation Failed</h3>
                            <p class="text-lg text-gray-700">Sorry, we couldn't find your compatibility right now. Please try again later.</p>
                            <button onclick="document.querySelector('.result-container').remove();" class="mt-6 px-6 py-3 bg-teal-500 text-white font-semibold rounded-full hover:bg-teal-600 transition-colors duration-300">Close</button>
                        </div>
                    `;
                }
            }, 3000);
        }

        // ===============================================
        // Hook Me Page Logic (New)
        // ===============================================
        const mockUsers = [
            { id: 'user-001', name: 'Alice', age: 28, sex: 'female', image: 'https://placehold.co/400x400/e0e7ff/6366f1?text=Alice', dob: '1996-05-15', place: 'San Francisco', likes: ['hiking', 'coffee'], dislikes: ['spiders'], hobbies: ['painting'], profession: 'Software Engineer', places: ['Italy'], movies: ['Lord of the Rings'] },
            { id: 'user-002', name: 'Bob', age: 31, sex: 'male', image: 'https://placehold.co/400x400/d1fae5/059669?text=Bob', dob: '1993-02-20', place: 'New York', likes: ['coding', 'sci-fi'], dislikes: ['laundry'], hobbies: ['guitar'], profession: 'Data Scientist', places: ['Japan'], movies: ['Star Wars'] },
            { id: 'user-003', name: 'Charlie', age: 25, sex: 'male', image: 'https://placehold.co/400x400/fecdd3/e11d48?text=Charlie', dob: '1999-11-01', place: 'London', likes: ['reading', 'board games'], dislikes: ['loud music'], hobbies: ['writing'], profession: 'Graphic Designer', places: ['Greece'], movies: ['Pulp Fiction'] },
            { id: 'user-004', name: 'Diana', age: 30, sex: 'female', image: 'https://placehold.co/400x400/bfdbfe/3b82f6?text=Diana', dob: '1994-08-08', place: 'Paris', likes: ['traveling', 'cooking'], dislikes: ['waking up early'], hobbies: ['photography'], profession: 'Chef', places: ['Thailand'], movies: ['Amelie'] },
            { id: 'user-005', name: 'Eve', age: 27, sex: 'female', image: 'https://placehold.co/400x400/c4b5fd/6d28d9?text=Eve', dob: '1997-03-22', place: 'Berlin', likes: ['music festivals', 'art'], dislikes: ['waiting in lines'], hobbies: ['DJing'], profession: 'Artist', places: ['Spain'], movies: ['Eternal Sunshine'] },
            { id: 'user-006', name: 'Frank', age: 33, sex: 'male', image: 'https://placehold.co/400x400/f0fdf4/16a34a?text=Frank', dob: '1991-09-30', place: 'Sydney', likes: ['surfing', 'baking'], dislikes: ['winter'], hobbies: ['gardening'], profession: 'Architect', places: ['Bali'], movies: ['Inception'] },
        ];

        let profileData = {}; // Store user data from Firestore
        const hookMeMainView = document.getElementById('hookme-main-view');
        const hookMeProfileView = document.getElementById('hookme-profile-view');
        const loggedInUserCard = document.getElementById('user-profile-card');
        const otherUsersGrid = document.getElementById('other-users-grid');
        const loadingUsersIndicator = document.getElementById('loading-users');
        const noUsersMessage = document.getElementById('no-users-message');
        
        function setupHookMePage() {
            if (!db || !userId) return;

            // Display logged-in user's UID for debugging and clarity
            const uidDisplay = document.createElement('p');
            uidDisplay.className = 'text-sm text-gray-500 mt-2';
            uidDisplay.textContent = `Your ID: ${userId}`;
            document.getElementById('logged-in-user').appendChild(uidDisplay);
            
            // Set up a real-time listener for all user profiles in the public collection
            const publicUsersCollection = collection(db, `/artifacts/${appId}/public/data/users`);
            onSnapshot(publicUsersCollection, (snapshot) => {
                profileData = {};
                snapshot.forEach(doc => {
                    const data = doc.data();
                    profileData[doc.id] = { id: doc.id, ...data };
                });
                renderHookMePage();
            }, (error) => {
                console.error("Error fetching users from Firestore:", error);
                loadingUsersIndicator.classList.add('hidden');
            });

            // Add listener for the Add Mock User button
            document.getElementById('add-mock-user-btn').addEventListener('click', addMockUser);
        }

        async function addMockUser() {
            if (!db) {
                console.error("Firestore is not initialized.");
                return;
            }
            const randomUser = mockUsers[Math.floor(Math.random() * mockUsers.length)];
            const userWithId = { ...randomUser, id: 'user-' + Date.now(), dob: '1990-01-01' }; // Use a real DOB string
            
            try {
                const publicUsersCollection = collection(db, `/artifacts/${appId}/public/data/users`);
                await addDoc(publicUsersCollection, userWithId);
                console.log("Mock user added successfully.");
            } catch (error) {
                console.error("Error adding mock user to Firestore:", error);
            }
        }

        function renderHookMePage() {
            if (!userId) return;
            
            // Find the logged-in user and filter for other users
            loggedInUser = profileData[userId];
            if (!loggedInUser) {
                // If the current user doesn't exist in the database, create a mock profile for them
                // This is a temporary placeholder. A real app would have a sign-up flow.
                const userSex = Math.random() > 0.5 ? 'male' : 'female';
                loggedInUser = {
                    id: userId,
                    name: 'Guest User',
                    age: Math.floor(Math.random() * 20) + 20,
                    sex: userSex,
                    image: `https://placehold.co/400x400/9ca3af/ffffff?text=You`,
                    dob: '1995-01-01',
                    place: 'Nowhere',
                    likes: [], dislikes: [], hobbies: [], profession: 'Explorer', places: [], movies: []
                };
            }

            // Filter for users of the opposite sex, excluding the current user
            otherUsers = Object.values(profileData).filter(user => user.id !== userId && user.sex !== loggedInUser.sex);
            
            renderLoggedInUserCard();
            renderOtherUsersGrid();
        }

        function renderLoggedInUserCard() {
            if (!loggedInUser) return;
            loggedInUserCard.innerHTML = `
                <img src="${loggedInUser.image}" alt="${loggedInUser.name}" class="w-24 h-24 rounded-full mx-auto object-cover mb-2">
                <h4 class="text-xl font-bold">${loggedInUser.name}, ${loggedInUser.age}</h4>
                <p class="text-sm text-gray-500">${loggedInUser.place}</p>
            `;
        }

        function renderOtherUsersGrid() {
            loadingUsersIndicator.classList.add('hidden');
            otherUsersGrid.innerHTML = '';
            if (otherUsers.length === 0) {
                noUsersMessage.classList.remove('hidden');
            } else {
                noUsersMessage.classList.add('hidden');
                otherUsers.forEach(user => {
                    const userCard = document.createElement('div');
                    userCard.className = 'flex flex-col items-center text-center cursor-pointer hover:bg-gray-100 p-2 rounded-lg transition-colors duration-200';
                    userCard.onclick = () => showDetailedProfile(user);
                    userCard.innerHTML = `
                        <img src="${user.image}" alt="${user.name}" class="w-20 h-20 rounded-full object-cover mb-1">
                        <h5 class="text-base font-semibold">${user.name}</h5>
                        <p class="text-sm text-gray-500">${user.age}</p>
                    `;
                    otherUsersGrid.appendChild(userCard);
                });
            }
        }

        function showDetailedProfile(user) {
            hookMeMainView.classList.add('hidden');
            hookMeProfileView.classList.remove('hidden');
            
            const profileContent = document.getElementById('detailed-user-profile-content');
            profileContent.innerHTML = `
                <div class="text-center mb-6">
                    <img src="${user.image}" alt="${user.name}" class="w-40 h-40 rounded-full mx-auto object-cover mb-4 shadow-lg border-4 border-yellow-300">
                    <h3 class="text-3xl font-bold font-playfair text-yellow-800">${user.name}, ${user.age}</h3>
                    <p class="text-lg text-gray-600">${user.profession} from ${user.place}</p>
                </div>
                <div class="space-y-4 text-gray-700">
                    <p><strong>Hobbies:</strong> ${user.hobbies.join(', ')}</p>
                    <p><strong>Likes:</strong> ${user.likes.join(', ')}</p>
                    <p><strong>Dislikes:</strong> ${user.dislikes.join(', ')}</p>
                    <p><strong>Favorite Movies:</strong> ${user.movies.join(', ')}</p>
                    <p><strong>Favorite Places:</strong> ${user.places.join(', ')}</p>
                </div>
            `;
        }

        function showHookMeMainView() {
            hookMeProfileView.classList.add('hidden');
            hookMeMainView.classList.remove('hidden');
        }

        function handleHookMeAction(action) {
            // Use a custom message box instead of alert()
            const messageBox = document.createElement('div');
            messageBox.className = 'fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 p-6 bg-yellow-200 rounded-lg shadow-xl border-2 border-yellow-500 z-50 animate-bounceIn';
            messageBox.innerHTML = `
                <p class="text-lg text-yellow-800 font-semibold">${action} action triggered!</p>
                <button onclick="this.parentElement.remove();" class="mt-4 px-4 py-2 bg-yellow-500 text-white rounded-full">OK</button>
            `;
            document.body.appendChild(messageBox);
        }

        // Add event listeners for the chat pages on page load
        document.addEventListener('DOMContentLoaded', () => {
            showPage('home-page');

            // Set up event listeners for each chat page's input and button
            const chatPages = ['single', 'new-couple', 'married'];
            chatPages.forEach(chatId => {
                const sendButton = document.getElementById(chatId + '-chat-send-btn');
                const inputField = document.getElementById(chatId + '-chat-input');

                if (sendButton) {
                    sendButton.addEventListener('click', () => handleChat(chatId));
                }
                if (inputField) {
                    inputField.addEventListener('keypress', (event) => {
                        if (event.key === 'Enter') {
                            handleChat(chatId);
                        }
                    });
                }
            });

            // Add event listener for the Lovematch form
            document.getElementById('flames-form').addEventListener('submit', runFlamesGame);
            
            // Add event listener for the new Compatibility form
            document.getElementById('compatibility-form').addEventListener('submit', runCompatibilityCheck);
        });
    </script>
</body>
</html>
